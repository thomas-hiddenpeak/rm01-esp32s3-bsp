# ESP32S3 控制台使用指南

## 🔧 问题修复

已修复控制台提示符不停滚动的问题：

### 修复内容：
1. **优化控制台输入逻辑** - 只在需要时显示提示符
2. **字符级输入处理** - 支持实时字符输入和退格
3. **减少日志输出** - 设置日志级别为WARN，减少干扰
4. **优化监控任务** - 减少监控频率，避免频繁输出

## 🚀 使用方法

### 1. 烧录程序
```bash
idf.py -p COMx flash monitor
```

### 2. 控制台操作
- **波特率**: 115200
- **终端软件**: 支持任何串口终端（推荐PuTTY、Tera Term、或VS Code串口监视器）
- **字符编码**: UTF-8

### 3. 控制台特性
- ✅ 实时字符输入
- ✅ 支持退格键编辑
- ✅ 命令行历史缓冲
- ✅ 中文提示信息
- ✅ 智能提示符管理

## 📝 命令列表

### 系统命令
```
help          - 显示帮助信息
info          - 显示系统信息  
status        - 显示当前状态
reboot        - 重启系统
```

### 风扇控制
```
fan 50        - 设置风扇50%速度
fan on        - 打开风扇(默认50%)
fan off       - 关闭风扇
```

### 板载LED控制 (28颗LED)
```
bled 255 0 0      - 红色
bled 0 255 0      - 绿色  
bled 0 0 255      - 蓝色
bled rainbow      - 彩虹效果
bled bright 30    - 设置亮度30%
bled off          - 关闭LED
```

### 触摸LED控制 (1颗LED)
```
tled 255 165 0    - 橙色
tled bright 80    - 设置亮度80%
tled off          - 关闭LED
```

### GPIO控制
```
gpio 2 high       - 设置GPIO2高电平
gpio 2 low        - 设置GPIO2低电平
gpio 2 read       - 读取GPIO2状态
```

## 🎯 使用技巧

### 输入技巧
- 输入命令后按回车执行
- 使用退格键删除字符
- 命令不区分大小写（除GPIO引脚号）

### 调试技巧
- 使用 `status` 命令查看系统状态
- 使用 `info` 命令查看硬件信息
- 出现问题时使用 `reboot` 重启

### 效果演示
```bash
# 风扇测试
fan 25
fan 50  
fan 75
fan off

# LED彩虹演示
bled rainbow
bled bright 100
bled bright 30

# GPIO测试
gpio 2 high
gpio 2 read
gpio 2 low
```

## ⚠️ 注意事项

1. **串口连接**：确保串口连接正常，波特率115200
2. **命令格式**：严格按照格式输入，参数用空格分隔
3. **数值范围**：
   - RGB值：0-255
   - 亮度：0-100%
   - 风扇速度：0-100%
   - GPIO引脚：根据ESP32S3规格
4. **实时性**：命令执行立即生效
5. **内存监控**：系统会自动监控内存使用

## 🐛 故障排除

### 提示符滚动问题
- ✅ 已修复：现在提示符只在需要时显示

### 无法输入命令
- 检查串口连接
- 确认波特率115200
- 尝试重启设备

### 命令无响应  
- 检查命令格式
- 使用 `help` 查看正确语法
- 尝试 `reboot` 重启

### LED不亮
- 检查硬件连接
- 确认引脚配置正确
- 尝试降低亮度测试

---

🎉 **现在您可以正常使用控制台了！输入命令不会再被滚动打断。**
